---
title: "Sleep stress"
author: "Riya"
date: "2023-10-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Libraries

```{r}
library(arules)
library(dplyr)
library(tidyverse)
```

# Reading and cleaning dataset

```{r}
dfs<-read.csv(file="https://raw.githubusercontent.com/riyaeliza123/sleepstress/main/SLEEP%20QUALITY.csv")
#View(dfs)

#Giving new column names
colnames(dfs) <- c('Timestamp','Gender','Age','Major','Diagnosed?','Treatment','Bedtime','Fall_asleep','Wakeup_time','Sleep_time','Sleep.30min','Sleep.wakeUpMiddle','Sleep.bathroom','Sleep.snore','Sleep.cold','Sleep.hot','Sleep.badDreams','Sleep.pain','Stress.assignment','Stress.exams','Stress.ketchup','Stress.newPerson','Stress.help','Stress.confronting','Stress.noHelp')

#copying dfs into temp to manipulate dfs
temp <- dfs 

#Converting categorical columns to numerical categories

levels <- c('Not during the past month','Less than once a week',
                                'Once or twice a week','Three or more times a week')
labels <- c(1,2,3,4)

dfs$Sleep.30min=factor(dfs$Sleep.30min, levels = levels, labels = labels)

dfs$Sleep.wakeUpMiddle=factor(dfs$Sleep.wakeUpMiddle, levels = levels, labels = labels)

dfs$Sleep.bathroom=factor(dfs$Sleep.bathroom, levels = levels, labels = labels)

dfs$Sleep.snore=factor(dfs$Sleep.snore, levels = levels, labels = labels)

dfs$Sleep.cold=factor(dfs$Sleep.cold, levels = levels, labels = labels)

dfs$Sleep.hot=factor(dfs$Sleep.hot, levels = levels, labels = labels)

dfs$Sleep.badDreams=factor(dfs$Sleep.badDreams, levels = levels, labels = labels)

dfs$Sleep.pain=factor(dfs$Sleep.pain, levels = levels, labels = labels)

dfs$Fall_asleep = factor(dfs$Fall_asleep, 
                         levels=c('under 30 minutes','30 minutes','1 hour','1.5 hours', 
                                  '2 hours', 'More time than that'), 
                         labels=c(1,2,3,4,5,6))
dfs$Sleep_time = factor(dfs$Sleep_time, 
                        levels=c('less than 4 hours of sleep','4-6 hours',
                                 '7-8 hours','more than 8 hours'), 
                        labels=c(1,2,3,4))
```

```{r}
View(dfs)
```

# Creating df.sleep containing all sleep related columns

```{r}
df.sleep<-data.frame(dfs[8],dfs[10:18])
#View(df.sleep)
df.sleep_num <- lapply(df.sleep,as.numeric) #convert to numeric list

df.sleep <- data.frame(df.sleep_num) #convert back to dataframe

df.sleep$INDEX_sleep <- rowSums(df.sleep, na.rm=TRUE)
View(df.sleep)
```

# Normalizing INDEX and creating a new column with the normalized values

```{r}
# Define a function to normalize a column to a specified range
normalize_to_range <- function(column, min_value, max_value, new_min, new_max) {
  # Normalize the values to the new range
  normalized_values <- ((column - min_value) / (max_value - min_value)) * (new_max - new_min) + new_min
  
  # Round the normalized values to the nearest integer
  normalized_values <- round(normalized_values)
  
  # Ensure the values are within the specified range (1 to 5)
  normalized_values <- pmax(pmin(normalized_values, new_max), new_min)
  
  return(normalized_values)
}

# Specify the range for the new values (1 to 5)
new_min <- 1
new_max <- 5

# Get the minimum and maximum values of the column you want to normalize
min_value <- min(df.sleep$INDEX_sleep)
max_value <- max(df.sleep$INDEX_sleep)

# Normalize the specified column
df.sleep$normINDEX_sleep <- normalize_to_range(df.sleep$INDEX_sleep, min_value, max_value, new_min, new_max)

View(df.sleep)

```

#Encoding data for df.stress

```{r}
levels = c('not stressed','mild','moderate','severe','very severe')
labels = c(1, 2, 3, 4, 5)

dfs$Stress.assignment=factor(dfs$Stress.assignment, levels = levels, labels = labels)

dfs$Stress.exams=factor(dfs$Stress.exams, levels = levels, labels = labels)

dfs$Stress.ketchup=factor(dfs$Stress.ketchup, levels = levels, labels = labels)

dfs$Stress.newPerson=factor(dfs$Stress.newPerson, levels = levels, labels = labels)

dfs$Stress.help=factor(dfs$Stress.help, levels = levels, labels = labels)

dfs$Stress.confronting=factor(dfs$Stress.confronting, levels = levels, labels = labels)

dfs$Stress.noHelp=factor(dfs$Stress.noHelp, levels = levels, labels = labels)

```

# Creating the stress dataframe

```{r}
df.stress <- data.frame(dfs[19:25])

#convert to numeric list
df.stress_num <- lapply(df.stress,as.numeric) 

#convert back to dataframe
df.stress <- data.frame(df.stress_num) 

df.stress$INDEX_stress <- rowSums(df.stress, na.rm=TRUE)
View(df.stress)
```
